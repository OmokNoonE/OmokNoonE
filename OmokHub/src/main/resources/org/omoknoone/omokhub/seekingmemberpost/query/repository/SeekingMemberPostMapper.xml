<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.omoknoone.omokhub.seekingmemberpost.query.repository.SeekingMemberPostMapper">

    <resultMap id="seekingMemberPostResultMap" type="org.omoknoone.omokhub.seekingmemberpost.query.SeekingMemberPostDTO">
        <id property="title" column="TITLE"/>
        <result property="seekingMember" column="SEEKING_MEMBER"/>
        <result property="startDate" column="START_DATE"/>
        <result property="endDate" column="END_DATE"/>
        <result property="techStack" column="TECH_STACK"/>
        <result property="Content" column="CONTENT"/>
        <result property="lastModifiedDate" column="LAST_MODIFIED_DATE"/>
        <result property="memberId" column="MEMBER_ID"/>
        <result property="maxMember" column="MAX_MEMBER"/>
        <result property="currentMember" column="CURRENT_MEMBER"/>
    </resultMap>

    <!-- 모집글 목록 -->
    <select id="selectSeekingMemberPostList" resultMap="seekingMemberPostResultMap">
        SELECT
              TITLE
            , SEEKING_MEMBER
            , START_DATE
            , TECH_STACK
         FROM SEEKING_MEMBER_POST
        WHERE IS_SEEKING = 1
          AND IS_DELETED = 0
    </select>

    <!-- 모집글 상세보기 -->
    <select id="selectSeekingMemberPostDetail" parameterType="int" resultMap="seekingMemberPostResultMap">
        SELECT
              A.TITLE
            , A.SEEKING_MEMBER
            , A.START_DATE
            , A.END_DATE
            , A.TECH_STACK
            , A.CONTENT
            , A.LAST_MODIFIED_DATE
            , B.MEMBER_ID
         FROM SEEKING_MEMBER_POST A
         JOIN MEMBER B ON (A.MEMBER_ID = B.MEMBER_ID)
        WHERE A.SEEKING_MEMBER_POST_ID = #{seekingMemberPostId}
    </select>

    <!-- 내가 작성한 모집글 목록 -->
    <select id="selectSeekingMemberPostByMyPost" parameterType="string" resultMap="seekingMemberPostResultMap">
        SELECT
              A.TITLE
            , A.START_DATE
            , A.END_DATE
            , C.MAX_MEMBER
            , C.CURRENT_MEMBER
         FROM SEEKING_MEMBER_POST A
         JOIN PROJECT B ON (A.PROJECT_ID = B.PROJECT_ID)
         JOIN PROJECT_TEAM C ON(B.PROJECT_TEAM_ID = C.PROJECT_TEAM_ID)
        WHERE A.MEMBER_ID = #{memberId}
    </select>

    <!-- 검색조건에 따른 모집글 목록 검색 (+정렬) -->
</mapper>